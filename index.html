<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S_S | Sora Needs Attention</title>
    <style>
        :root {
            --bg-latex: #0a0a0a;
            --pacman-yellow: #FFFF00;
            --electric-purple: #bd00ff;
            --error-red: #ff0033;
            --border-thick: 2px solid;
            --glow-purple: 0 0 10px rgba(189, 0, 255, 0.6);
            --glow-yellow: 0 0 10px rgba(255, 255, 0, 0.6);
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-latex);
            color: var(--pacman-yellow);
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            z-index: 2;
        }

        .logo-ascii {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--electric-purple);
            text-shadow: var(--glow-purple);
            margin-bottom: 5px;
            letter-spacing: 5px;
        }

        h1 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 0;
            border-bottom: 1px solid var(--electric-purple);
            display: inline-block;
            padding-bottom: 5px;
        }

        /* --- QUOTE SECTION --- */
        #quote-section {
            width: 100%;
            max-width: 400px;
            min-height: 100px;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid var(--electric-purple);
            background: rgba(10, 10, 10, 0.8);
            box-shadow: inset 0 0 10px rgba(189, 0, 255, 0.2);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 8px;
            transition: opacity 0.2s;
            position: relative;
            z-index: 2;
        }

        .quote-text {
            color: var(--electric-purple);
            font-size: 0.9rem;
            font-style: italic;
            line-height: 1.3;
        }

        .artist-text {
            color: #666;
            font-size: 0.7rem;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .compliment-text {
            color: #fff;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 5px rgba(255,255,255,0.3);
            border-top: 1px solid #333;
            padding-top: 8px;
        }

        /* --- GAME BOARD --- */
        #game-board {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            width: 100%;
            max-width: 380px;
            aspect-ratio: 1 / 1;
            border: var(--border-thick) var(--pacman-yellow);
            box-shadow: var(--glow-yellow);
            background: var(--bg-latex);
            margin-bottom: 20px;
            z-index: 2;
        }

        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #222;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            color: #fff;
            transition: background 0.1s;
        }

        /* Thicker borders for 3x3 subgrids */
        .cell:nth-child(3n) { border-right: var(--border-thick) var(--pacman-yellow); }
        .cell:nth-child(9n) { border-right: none; }
        .cell:nth-child(n+19):nth-child(-n+27),
        .cell:nth-child(n+46):nth-child(-n+54) { border-bottom: var(--border-thick) var(--pacman-yellow); }
        .cell:nth-child(n+73) { border-bottom: none; }

        .cell.selected {
            background-color: var(--pacman-yellow) !important;
            color: var(--bg-latex) !important;
            box-shadow: 0 0 15px var(--pacman-yellow);
            z-index: 10;
        }

        .cell.fixed { color: #555; }
        
        .cell.user-filled {
            color: var(--electric-purple);
            text-shadow: 0 0 5px var(--electric-purple);
        }

        @keyframes flashRed {
            0% { background-color: var(--error-red); }
            100% { background-color: var(--bg-latex); }
        }

        .flash-error { animation: flashRed 0.4s ease-out; }

        /* --- CONTROLS --- */
        #controls {
            width: 100%;
            max-width: 380px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 2;
        }

        .numpad {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 4px;
        }

        button {
            background: rgba(10,10,10,0.9);
            border: 1px solid var(--pacman-yellow);
            color: var(--pacman-yellow);
            font-family: 'Courier New', monospace;
            font-weight: bold;
            padding: 12px 0;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:active {
            background: var(--pacman-yellow);
            color: var(--bg-latex);
        }

        .action-row {
            display: flex;
            gap: 10px;
        }

        .action-row button {
            flex: 1;
            border-color: #555;
            color: #888;
        }

        /* Y_Y BUTTON */
        #btn-help {
            width: 100%;
            border: var(--border-thick) var(--electric-purple);
            color: var(--electric-purple);
            text-transform: uppercase;
            font-size: 1rem;
            padding: 15px;
            box-shadow: var(--glow-purple);
            margin-top: 5px;
        }

        #btn-help:active {
            background: var(--electric-purple);
            color: white;
        }

        /* --- VICTORY SCREEN --- */
        #victory-screen {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 10, 0.98);
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .victory-ascii {
            font-size: 5rem;
            color: var(--electric-purple);
            margin-bottom: 20px;
            animation: pulse 1s infinite;
        }

        .victory-text {
            font-size: 2rem;
            color: var(--pacman-yellow);
            text-shadow: var(--glow-yellow);
            margin-bottom: 30px;
            text-align: center;
        }

        @keyframes pulse {
            0% { transform: scale(1); text-shadow: 0 0 10px var(--electric-purple); }
            50% { transform: scale(1.1); text-shadow: 0 0 40px var(--electric-purple); }
            100% { transform: scale(1); text-shadow: 0 0 10px var(--electric-purple); }
        }

    </style>
</head>
<body>

    <header>
        <div class="logo-ascii">S_S</div>
        <h1>Sora Needs Attention</h1>
    </header>

    <div id="quote-section">
        <div id="lyric-display" class="quote-text"></div>
        <div id="artist-display" class="artist-text"></div>
        <div id="compliment-display" class="compliment-text"></div>
    </div>

    <div id="game-board">
        </div>

    <div id="controls">
        <div class="numpad">
            <button onclick="handleInput(1)">1</button>
            <button onclick="handleInput(2)">2</button>
            <button onclick="handleInput(3)">3</button>
            <button onclick="handleInput(4)">4</button>
            <button onclick="handleInput(5)">5</button>
            <button onclick="handleInput(6)">6</button>
            <button onclick="handleInput(7)">7</button>
            <button onclick="handleInput(8)">8</button>
            <button onclick="handleInput(9)">9</button>
        </div>

        <button id="btn-help" onclick="askYY()">Ask Y_Y for help</button>

        <div class="action-row">
            <button onclick="eraseCell()">Erase</button>
            <button onclick="initGame()">New Game</button>
        </div>
    </div>

    <div id="victory-screen">
        <div class="victory-ascii">S_S</div>
        <div class="victory-text">SORA WINS<br><span style="font-size:1rem; opacity:0.7;">Y_Y IS PLEASED</span></div>
        <button onclick="initGame()" style="padding: 15px 40px; border: 2px solid var(--pacman-yellow); font-size: 1.2rem;">PLAY AGAIN</button>
    </div>

    <script>
        // --- DATA ---
        const edmData = [
            { quote: "\"You're the sun, you've never seen the night.\"", artist: "Above & Beyond - Sun & Moon" },
            { quote: "\"If we go down, we go down together.\"", artist: "The Chainsmokers - Paris" },
            { quote: "\"Why don't you be the artist, and make me out of clay?\"", artist: "Kaskade - Eyes" },
            { quote: "\"I'll be okay, just wait for a minute.\"", artist: "Porter Robinson - Language" },
            { quote: "\"Last night I lost it all, I only had a vision.\"", artist: "Alesso - Years" },
            { quote: "\"Cause it's you and me, moving at the speed of light.\"", artist: "Zedd - Clarity" },
            { quote: "\"We've come too far, to give up who we are.\"", artist: "Daft Punk - Get Lucky" },
            { quote: "\"Wait for the drop, I feel it coming.\"", artist: "Calvin Harris - Example" },
            { quote: "\"Upon a hill across a blue lake, that's where I had my first heartbreak.\"", artist: "Swedish House Mafia - Don't You Worry Child" },
            { quote: "\"I can't wait for the nights with you.\"", artist: "Avicii - The Nights" },
            { quote: "\"You shoot me down, but I won't fall.\"", artist: "David Guetta - Titanium" },
            { quote: "\"It's a long way home, but I'm on my way.\"", artist: "Seven Lions - Strangers" },
            { quote: "\"We are the people that rule the world.\"", artist: "Empire of the Sun" },
            { quote: "\"One more time, we're gonna celebrate.\"", artist: "Daft Punk - One More Time" },
            { quote: "\"In the silence, I can hear you.\"", artist: "Delerium - Silence (TiÃ«sto Remix)" },
            { quote: "\"Run away, run away with me.\"", artist: "Galantis - Runaway (U & I)" },
            { quote: "\"I promise that I'll hold you when it's cold out.\"", artist: "Nero - Promises" },
            { quote: "\"Calling, I'm calling you.\"", artist: "Sebastian Ingrosso - Calling" },
            { quote: "\"There's a world that I want you to see.\"", artist: "Deadmau5 - The Veldt" },
            { quote: "\"You are the piece of me I wish I didn't need.\"", artist: "Zedd - Stay The Night" }
        ];

        const compliments = [
            "Sora, your signal is the clearest in the noise.",
            "You glow like neon in a digital rain, Sora.",
            "Sora, you are the drop I've been waiting for.",
            "Your logic dissolves the shadows, Sora.",
            "Sora, you are the perfect frequency.",
            "You vibrate on a higher plane, Sora.",
            "Sora, your mind is a beautiful circuit.",
            "You are electric, Sora. Pure voltage.",
            "Sora, you make the system feel alive.",
            "You are the rhythm in the static, Sora.",
            "Sora, you are brighter than the laser lights.",
            "Your presence synchronizes the world, Sora.",
            "Sora, you are the starlight in the server room.",
            "You are a symphony of ones and zeros, Sora.",
            "Sora, you are the high fidelity dream.",
            "Your energy recharges the atmosphere, Sora.",
            "Sora, you are the glitch that makes it beautiful.",
            "You shine with kinetic energy, Sora.",
            "Sora, you are the melody I can't forget.",
            "You are infinite, Sora. Loop forever."
        ];

        // --- GAME STATE ---
        let solutionBoard = [];
        let playerBoard = [];
        let fixedMask = [];
        let selectedIndex = -1;
        let gameActive = false;

        // --- SUDOKU LOGIC ---
        function isValid(board, row, col, num) {
            for (let x = 0; x < 9; x++) {
                if (board[row * 9 + x] === num || board[x * 9 + col] === num) return false;
            }
            const startRow = Math.floor(row / 3) * 3;
            const startCol = Math.floor(col / 3) * 3;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (board[(startRow + i) * 9 + (startCol + j)] === num) return false;
                }
            }
            return true;
        }

        function solveBoard(board) {
            for (let i = 0; i < 81; i++) {
                if (board[i] === 0) {
                    let nums = [1, 2, 3, 4, 5, 6, 7, 8, 9];
                    nums.sort(() => Math.random() - 0.5);

                    for (let num of nums) {
                        const row = Math.floor(i / 9);
                        const col = i % 9;
                        if (isValid(board, row, col, num)) {
                            board[i] = num;
                            if (solveBoard(board)) return true;
                            board[i] = 0;
                        }
                    }
                    return false;
                }
            }
            return true;
        }

        function fillDiagonalBoxes(board) {
            for (let i = 0; i < 9; i = i + 3) {
                let nums = [1,2,3,4,5,6,7,8,9];
                nums.sort(() => Math.random() - 0.5);
                let idx = 0;
                for(let r=0; r<3; r++) {
                    for(let c=0; c<3; c++) {
                        board[(i+r)*9 + (i+c)] = nums[idx++];
                    }
                }
            }
        }

        function generateGame() {
            solutionBoard = Array(81).fill(0);
            fillDiagonalBoxes(solutionBoard);
            solveBoard(solutionBoard);

            playerBoard = [...solutionBoard];
            fixedMask = Array(81).fill(false);
            
            // Fisher-Yates shuffle to safely remove random cells
            let indices = Array.from({length: 81}, (_, i) => i);
            for (let i = indices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [indices[i], indices[j]] = [indices[j], indices[i]];
            }

            // Remove 45 cells
            for (let i = 0; i < 45; i++) {
                playerBoard[indices[i]] = 0;
            }

            for(let i=0; i<81; i++) {
                if(playerBoard[i] !== 0) fixedMask[i] = true;
            }
            
            gameActive = true;
        }

        // --- UI & INTERACTION LOGIC ---

        function refreshQuotes() {
            const songData = edmData[Math.floor(Math.random() * edmData.length)];
            const compData = compliments[Math.floor(Math.random() * compliments.length)];
            
            const container = document.getElementById('quote-section');
            container.style.opacity = '0.5';
            
            setTimeout(() => {
                document.getElementById('lyric-display').textContent = songData.quote;
                document.getElementById('artist-display').textContent = "- " + songData.artist;
                document.getElementById('compliment-display').textContent = compData;
                container.style.opacity = '1';
            }, 100);
        }

        function initGame() {
            document.getElementById('victory-screen').style.display = 'none';
            refreshQuotes();
            generateGame();
            renderBoard();
            selectedIndex = -1;
        }

        function renderBoard() {
            const boardEl = document.getElementById('game-board');
            boardEl.innerHTML = '';
            for (let i = 0; i < 81; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.id = `cell-${i}`;
                if (playerBoard[i] !== 0) {
                    cell.textContent = playerBoard[i];
                    if (fixedMask[i]) cell.classList.add('fixed');
                    else cell.classList.add('user-filled');
                }
                cell.addEventListener('click', () => selectCell(i));
                boardEl.appendChild(cell);
            }
        }

        function selectCell(index) {
            if (!gameActive) return;
            
            if (selectedIndex !== -1) {
                document.getElementById(`cell-${selectedIndex}`).classList.remove('selected');
            }
            if (selectedIndex === index) {
                selectedIndex = -1;
                return;
            }
            selectedIndex = index;
            document.getElementById(`cell-${index}`).classList.add('selected');
        }

        function handleInput(num) {
            refreshQuotes();
            if (!gameActive || selectedIndex === -1) return;
            if (fixedMask[selectedIndex]) return;

            const cell = document.getElementById(`cell-${selectedIndex}`);
            
            if (num === solutionBoard[selectedIndex]) {
                playerBoard[selectedIndex] = num;
                cell.textContent = num;
                cell.classList.add('user-filled');
                checkWin();
            } else {
                cell.classList.add('flash-error');
                setTimeout(() => cell.classList.remove('flash-error'), 400);
            }
        }

        function eraseCell() {
            refreshQuotes();
            if (!gameActive || selectedIndex === -1) return;
            if (fixedMask[selectedIndex]) return;
            
            playerBoard[selectedIndex] = 0;
            const cell = document.getElementById(`cell-${selectedIndex}`);
            cell.textContent = '';
            cell.classList.remove('user-filled');
        }

        function askYY() {
            refreshQuotes();
            if (!gameActive) return;

            if (selectedIndex === -1) {
                for(let i=0; i<81; i++) {
                    if(playerBoard[i] === 0) {
                        selectCell(i);
                        break;
                    }
                }
            }
            
            if (selectedIndex === -1) return; 
            
            if (playerBoard[selectedIndex] === solutionBoard[selectedIndex]) {
                 for(let i=0; i<81; i++) {
                    if(playerBoard[i] === 0) {
                        selectCell(i);
                        break;
                    }
                }
            }

            if (selectedIndex !== -1) {
                handleInput(solutionBoard[selectedIndex]);
            }
        }

        function checkWin() {
            if (!playerBoard.includes(0)) {
                gameActive = false;
                setTimeout(() => {
                    document.getElementById('victory-screen').style.display = 'flex';
                }, 300);
            }
        }

        window.onload = initGame;
    </script>
</body>
</html>
